<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<title>гоночна 2Д-мінігра</title>
<style>
    body {
        margin: 0;
        background: #222;
        font-family: Arial;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    #menu, #gameOver {
        position: absolute;
        text-align: center;
        color: white;
    }
    button {
        padding: 15px 30px;
        margin-top: 20px;
        font-size: 20px;
        cursor: pointer;
        border-radius: 10px;
        border: none;
    }
    canvas {
        background: #444;
        border: 3px solid #000;
    }
    #score {
        position: absolute;
        top: 10px;
        left: 10px;
        color: white;
        font-size: 24px;
        display:
    #controls {
        position: absolute;
        bottom: 20px;
        width: 100%;
        display: flex;
        justify-content: space-around;
        align-items: center;
        display: none;
    }
    .ctrl-btn {
        width: 100px;
        height: 100px;
        background: rgba(255,255,255,0.2);
        border-radius: 50%;
        font-size: 40px;
        color: white;
        border: 2px solid white;
        user-select: none;
    }
</style>
</head>
<body>

<div id="menu">
    <h1>гоночна 2Д-мінігра</h1>
    <button onclick="startGame()">Старт</button>
</div>

<div id="gameOver" style="display:none;">
    <h1>Гру закінчено</h1>
    <p id="finalScore"></p>
    <button onclick="startGame()">Грати знову</button>
</div>

<div id="score">Очки: 0</div>


 <div id="controls">
 <div class="ctrl-btn" id="btnLeft">←</div>
 <div class="ctrl-btn" id="btnRight">→</div>
 </div>

<canvas id="game" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let player, enemies, enemySpeed, keys, score, gameOverState;


function startGame() {
    document.getElementById("menu").style.display = "none";
    document.getElementById("gameOver").style.display = "none";
    document.getElementById("score").style.display = "block";
    document.getElementById("controls").style.display = "flex";

    player = { x: 180, y: 500, width: 40, height: 80, speed: 5 };
    enemies = [];
    enemySpeed = 3;
    keys = {};
    score = 0;
    gameOverState = false;

    
    document.onkeydown = (e) => keys[e.key] = true;
    document.onkeyup = (e) => keys[e.key] = false;

    
    document.getElementById("btnLeft").ontouchstart = () => keys["left"] = true;
    document.getElementById("btnLeft").ontouchend = () => keys["left"] = false;

    document.getElementById("btnRight").ontouchstart = () => keys["right"] = true;
    document.getElementById("btnRight").ontouchend = () => keys["right"] = false;

    setInterval(spawnEnemy, 1000);

    requestAnimationFrame(gameLoop);
}


function spawnEnemy() {
    if (gameOverState) return;
    const lane = Math.floor(Math.random() * 3);
    enemies.push({
        x: 80 * lane + 80,
        y: -100,
        width: 40,
        height: 80
    });
}


function updatePlayer() {

    
    if ((keys["ArrowLeft"] || keys["a"] || keys["A"]) && player.x > 20) {
        player.x -= player.speed;
    }
    if ((keys["ArrowRight"] || keys["d"] || keys["D"]) && player.x < 340) {
        player.x += player.speed;
    }

    
    if (keys["left"] && player.x > 20) player.x -= player.speed;
    if (keys["right"] && player.x < 340) player.x += player.speed;
}


function checkCollisions() {
    for (let e of enemies) {
        if (
            player.x < e.x + e.width &&
            player.x + player.width > e.x &&
            player.y < e.y + e.height &&
            player.y + player.height > e.y
        ) {
            endGame();
           }
      }
   }

function endGame() {
    gameOverState = true;
    document.getElementById("score").style.display = "none";
    document.getElementById("controls").style.display = "none";
    document.getElementById("finalScore").innerText = "Ваш рахунок: " + score;
    document.getElementById("gameOver").style.display = "block";
}


function drawPlayer() {
    ctx.fillStyle = "cyan";
    ctx.fillRect(player.x, player.y, player.width, player.height);
}

function drawEnemies() {
    ctx.fillStyle = "red";
    enemies.forEach(e => {
        ctx.fillRect(e.x, e.y, e.width, e.height);
        e.y += enemySpeed;

        if (e.y > 600) {
            enemies.splice(enemies.indexOf(e), 1);
            score++;
            document.getElementById("score").innerText = "Очки: " + score;
        }
    });
}

function gameLoop() {
    if (gameOverState) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    updatePlayer();
    drawPlayer();
    drawEnemies();
    checkCollisions();
    requestAnimationFrame(gameLoop);
}
    
</script>
</body>
</html>


